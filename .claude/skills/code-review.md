# Code Review

## 概要

効果的なコードレビューのガイドライン。セキュリティ観点、パフォーマンス観点、可読性観点からの体系的なレビュー手法と、建設的なフィードバックの提供方法を定義する。

## 適用場面

- Pull Requestのレビュー
- ペアプログラミング・モブプログラミング
- アーキテクチャ変更のレビュー
- セキュリティクリティカルなコードの監査

## ベストプラクティス

### 1. レビュー観点

- 正確性: ロジックが仕様・受入条件を満たしているか
- セキュリティ: インジェクション、認証・認可の不備がないか
- パフォーマンス: N+1問題、不要な再計算、メモリリークがないか
- 可読性: 命名、構造、コメントが適切か
- テスト: テストカバレッジが十分か、エッジケースが網羅されているか

### 2. レビュープロセス

- まず全体像を把握する（PRのdescription、変更ファイル一覧を確認）
- 大きな設計上の問題を先に指摘する（細部は後回し）
- 1回のレビューで全ての指摘を出す（往復を減らす）
- 重要度を明示する: `[must]` 修正必須, `[should]` 推奨, `[nit]` 些細
- レビュー時間は1PRあたり30-60分を目安とする

### 3. 建設的なフィードバック

- 「なぜ」を説明する。コードの問題だけでなく改善理由を伝える
- 代替案を提示する。批判だけでなく具体的な解決策を示す
- 良いコードには積極的にコメントする。学びの共有を促進する
- 個人ではなくコードに対してフィードバックする
- 質問形式で改善を促す: 「ここは X にするとどうでしょうか?」

### 4. 自動化との組み合わせ

- Linterの指摘事項は人間がレビューする前に解決する
- CIの全テストがパスしていることをレビュー開始の前提とする
- CODEOWNERS を設定してレビュアーの自動アサインを行う
- 依存関係の更新はDependabot/Renovateに任せ、人間は変更影響を確認する

## チェックリスト

- [ ] PRのdescriptionが変更内容を適切に説明している
- [ ] テストが追加・更新されている
- [ ] セキュリティ上の問題がない
- [ ] パフォーマンスへの悪影響がない
- [ ] 破壊的変更がある場合、移行手順が記載されている
- [ ] ドキュメントが必要に応じて更新されている
- [ ] CIが全てパスしている

## 関連スキル

- [セキュリティ監査](./security-audit.md)
- [パフォーマンス](./performance.md)
- [Gitワークフロー](./git-workflow.md)
